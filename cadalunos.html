<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Alunos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2c2c2c;
            color: white;
            padding: 20px;
            text-align: center;
        }

        input, button {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }

        input {
            width: 300px;
        }

        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
        }

        th, td {
            padding: 10px;
            border: 1px solid white;
        }

        th {
            background-color: #333;
        }
    </style>
</head>
<body>

    <h1>Cadastro de Alunos</h1>

    <form id="cadastroForm">
        <input type="text" id="codigoAluno" placeholder="Código do Aluno" required><br>
        <input type="text" id="nomeAluno" placeholder="Nome do Aluno" required><br>
        <input type="text" id="faixa" placeholder="Faixa" required><br>
        <input type="number" id="taxaGraduacao" placeholder="Taxa de Graduação" required><br>
        <input type="number" id="desconto" placeholder="Desconto (%)"><br>
        <input type="text" id="motivoDesconto" placeholder="Motivo do Desconto"><br>
        <input type="number" id="valorGraduacao" placeholder="Valor da Graduação" required><br>
        <input type="date" id="dataExame" required><br>
        <input type="date" id="dataEntregaFaixas" required><br>
        <button type="submit">Cadastrar Aluno</button>
    </form>

    <table id="tabelaAlunos">
        <thead>
            <tr>
                <th>Código</th>
                <th>Nome</th>
                <th>Faixa</th>
                <th>Taxa</th>
                <th>Desconto</th>
                <th>Motivo Desconto</th>
                <th>Valor</th>
                <th>Data Exame</th>
                <th>Data Entrega Faixas</th>
            </tr>
        </thead>
        <tbody>
            <!-- Alunos cadastrados serão exibidos aqui -->
        </tbody>
    </table>

    <script>
        const apiKey = 'AIzaSyASMZPLJzQ5GCLOzXJs4WRDn7FZTmwJrlg'; // Substitua pela sua chave API
        const spreadsheetId = '1D167AYSZ5imnfz0GqlJ_rchpwnCI-AIExa6pk2mO1ys'; // Substitua pelo ID da sua planilha
        const range = 'Folha1'; // Altere para o nome da aba e intervalo desejado

        document.getElementById('cadastroForm').onsubmit = function(event) {
            event.preventDefault();
            cadastrarAluno();
        };

        function cadastrarAluno() {
            const aluno = {
                codigo: document.getElementById("codigoAluno").value,
                nome: document.getElementById("nomeAluno").value,
                faixa: document.getElementById("faixa").value,
                taxa: document.getElementById("taxaGraduacao").value,
                desconto: document.getElementById("desconto").value || 0,
                motivo_desconto: document.getElementById("motivoDesconto").value || '',
                valor: document.getElementById("valorGraduacao").value,
                data_exame: document.getElementById("dataExame").value,
                data_entrega_faixas: document.getElementById("dataEntregaFaixas").value
            };

            const values = [
                [aluno.codigo, aluno.nome, aluno.faixa, aluno.taxa, aluno.desconto, aluno.motivo_desconto, aluno.valor, aluno.data_exame, aluno.data_entrega_faixas]
            ];

            const body = {
                values: values
            };

            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}:append?valueInputOption=USER_ENTERED&key=${apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                alert('Aluno cadastrado com sucesso!');
                carregarAlunos();
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao cadastrar aluno.');
            });
        }

        function carregarAlunos() {
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`)
            .then(response => response.json())
            .then(data => {
                const tabelaAlunos = document.getElementById("tabelaAlunos").getElementsByTagName("tbody")[0];
                tabelaAlunos.innerHTML = ''; // Limpar tabela
                data.values.forEach(row => {
                    const newRow = tabelaAlunos.insertRow();
                    row.forEach(cell => {
                        const newCell = newRow.insertCell();
                        newCell.textContent = cell;
                    });
                });
            })
            .catch(error => {
                console.error('Erro:', error);
            });
        }

        window.onload = carregarAlunos;
    </script>

</body>
</html>
